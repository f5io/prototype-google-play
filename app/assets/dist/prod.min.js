!function t(e,n,i){function a(r,s){if(!n[r]){if(!e[r]){var c="function"==typeof require&&require;if(!s&&c)return c(r,!0);if(o)return o(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[r]={exports:{}};e[r][0].call(l.exports,function(t){var n=e[r][1][t];return a(n?n:t)},l,l.exports,t,e,n,i)}return n[r].exports}for(var o="function"==typeof require&&require,r=0;r<i.length;r++)a(i[r]);return a}({1:[function(t){function e(){{var t=Math.min(500,Math.round(.8*n.windowWidth())),e=2*t+50,c="left",u="right",l="in",d="out",h=n('[role="container"]')[0],f=n('[role="arrows"]')[0],m=(n('[role="light"]')[0],n('[role="main"]')[0]),p=n('[role="cube"]')[0],g=n('[role="menu"]')[0],v=n('[role="loader"]')[0];n('[role="background"]')[0]}h.style[n.CSS_PERSPECTIVE]=e+"px";var y=i.global.isCeltra?i.BASE_URL:"";o.load([y+"assets/sound/click.mp3",y+"assets/img/cubes/music/side1.jpg",y+"assets/img/cubes/music/side2.jpg",y+"assets/img/cubes/music/side3.jpg",y+"assets/img/cubes/music/side4.jpg",y+"assets/img/cubes/music/side5.jpg",y+"assets/img/cubes/music/side6.jpg"]).then(function(){function e(e,i){i=i||u;var o=n.getElement("div","cube-container",{},{});p.appendChild(o);var s=Object.create(a);return s.init(t,t,0,e,o,{autoListen:!1,useInertia:!1,useBackgrounds:!0,useContent:!0,normaliseFacialRotation:!0}),s.getNormalisedFaceRotation(s.rotation,!0),s.render(),h(l,s,i),r.defineCubeProperties([s]),s}function h(t,e,i){return new Promise(function(a){var o=e.target,r=e.shadow,u=1.2*n.windowWidth(),h=function(){e.addInteractionListener()};t!==l||w?t===d&&(h=function(){o.parentNode.removeChild(r.element),o.parentNode.removeChild(o),e=null}):h=b;var f=t===d?0:i===c?-u:u,m=t===l?0:i===c?-u:u;o.style[n.CSS_TRANSFORM]+=" translateX("+f+"px)",r.translate.X=f,r.render(),s.tween().from(f).to(m).ease(s.easing[t===l?"easeOutCirc":"easeInCirc"]).step(function(t){o.style[n.CSS_TRANSFORM]=o.style[n.CSS_TRANSFORM].replace(/translateX\(.+\)/g,function(){return"translateX("+t+"px)"}),r.translate.X=1.1*t,r.render()}).complete(function(){h(e),a()}).start()})}function b(t){function e(c){s.tween().to(360).delay(400).duration(1e3).ease(s.easing.easeInOutQuad).step(function(e){a=a||e;var s=n.nearest(e,90),u=n.nearest(a,90);s!==u&&i.global.useSound&&t.sound.play(),t.rotation[r[c]]=o+e,t.render(),a=e}).complete(function(){if("LR"!==c){v.classList.add("off"),f.classList.remove("off");var i=n.emitter.on("first_cube_interaction",function(){f.classList.add("off"),i()});return void t.addInteractionListener()}a=void 0,t.forceRotationOfOppositeForFirstFace(),e("UD")}).start()}var a,o=0,r=t.getAxisDefinition(t.rotation);e("LR")}var w,x=0,C=["music","books","apps","movies"],E=[];n.emitter.on("debug_panel",function(t){m.classList[t?"add":"remove"]("covered")}),w=e(C[x]),C.forEach(function(t,n){var i=g.querySelector("."+t);E.push(i),i.addEventListener("tap",function(){if(!i.classList.contains("selected")){E.forEach(function(t){t.classList.remove("selected")}),document.body.className=g.className="border-"+t,i.classList.add("selected");var a=x>n?c:u,r=x>n?u:c;x=n,v.classList.remove("off");var s=!f.classList.contains("off");f.classList.add("off"),h(d,w,r).then(function(){for(var n=[],i=1,r=6;r>=i;i++)n.push(y+"assets/img/cubes/"+t+"/side"+i+".jpg");o.load(n).then(function(){v.classList.add("off"),s&&f.classList.remove("off"),w=e(t,a)})})}})}),document.addEventListener("touchmove",n.prevent)})}var n=t("./modules/utilities"),i=t("./modules/config"),a=t("./modules/cube"),o=(t("./modules/cube/shadow"),t("./modules/orient"),t("./modules/messaging"),t("./modules/background"),t("./modules/assetmanager")),r=t("./modules/debug"),s=(t("stats"),t("interpol"));n.isDefined(window.screen)&&n.isDefined(window.creative)?(i.global.isCeltra=!0,window.InitCube=e):n.ready(e)},{"./modules/assetmanager":5,"./modules/background":9,"./modules/config":10,"./modules/cube":15,"./modules/cube/shadow":17,"./modules/debug":19,"./modules/messaging":20,"./modules/orient":21,"./modules/utilities":22,interpol:2,stats:3}],2:[function(t,e){(function(n){__browserify_shim_require__=t,function(t,e,n,i,a){!function(e){"undefined"!=typeof t&&t.exports?t.exports=e(window):self.Interpol=self.iN=e(window)}(function(t){"use strict";var e={};e.fps=60,e.easing={easeNone:function(t,e,n,i){return n*t/i+e},easeInQuad:function(t,e,n,i){return n*(t/=i)*t+e},easeOutQuad:function(t,e,n,i){return-n*(t/=i)*(t-2)+e},easeInOutQuad:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,i){return n*(t/=i)*t*t+e},easeOutCubic:function(t,e,n,i){return n*((t=t/i-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,i){return n*(t/=i)*t*t*t+e},easeOutQuart:function(t,e,n,i){return-n*((t=t/i-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,i){return n*(t/=i)*t*t*t*t+e},easeOutQuint:function(t,e,n,i){return n*((t=t/i-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,i){return-n*Math.cos(t/i*(Math.PI/2))+n+e},easeOutSine:function(t,e,n,i){return n*Math.sin(t/i*(Math.PI/2))+e},easeInOutSine:function(t,e,n,i){return-n/2*(Math.cos(Math.PI*t/i)-1)+e},easeInExpo:function(t,e,n,i){return 0==t?e:n*Math.pow(2,10*(t/i-1))+e},easeOutExpo:function(t,e,n,i){return t==i?e+n:n*(-Math.pow(2,-10*t/i)+1)+e},easeInOutExpo:function(t,e,n,i){return 0==t?e:t==i?e+n:(t/=i/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(-Math.pow(2,-10*--t)+2)+e},easeInCirc:function(t,e,n,i){return-n*(Math.sqrt(1-(t/=i)*t)-1)+e},easeOutCirc:function(t,e,n,i){return n*Math.sqrt(1-(t=t/i-1)*t)+e},easeInOutCirc:function(t,e,n,i){return(t/=i/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,n,i){var a=1.70158,o=0,r=n;if(0==t)return e;if(1==(t/=i))return e+n;if(o||(o=.3*i),r<Math.abs(n)){r=n;var a=o/4}else var a=o/(2*Math.PI)*Math.asin(n/r);return-(r*Math.pow(2,10*(t-=1))*Math.sin(2*(t*i-a)*Math.PI/o))+e},easeOutElastic:function(t,e,n,i){var a=1.70158,o=0,r=n;if(0==t)return e;if(1==(t/=i))return e+n;if(o||(o=.3*i),r<Math.abs(n)){r=n;var a=o/4}else var a=o/(2*Math.PI)*Math.asin(n/r);return r*Math.pow(2,-10*t)*Math.sin(2*(t*i-a)*Math.PI/o)+n+e},easeInOutElastic:function(t,e,n,i){var a=1.70158,o=0,r=n;if(0==t)return e;if(2==(t/=i/2))return e+n;if(o||(o=.3*i*1.5),r<Math.abs(n)){r=n;var a=o/4}else var a=o/(2*Math.PI)*Math.asin(n/r);return 1>t?-.5*r*Math.pow(2,10*(t-=1))*Math.sin(2*(t*i-a)*Math.PI/o)+e:r*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*i-a)*Math.PI/o)*.5+n+e},easeInBack:function(t,e,n,i,a){return void 0==a&&(a=1.70158),n*(t/=i)*t*((a+1)*t-a)+e},easeOutBack:function(t,e,n,i,a){return void 0==a&&(a=1.70158),n*((t=t/i-1)*t*((a+1)*t+a)+1)+e},easeInOutBack:function(t,e,n,i,a){return void 0==a&&(a=1.70158),(t/=i/2)<1?n/2*t*t*(((a*=1.525)+1)*t-a)+e:n/2*((t-=2)*t*(((a*=1.525)+1)*t+a)+2)+e},easeInBounce:function(t,e,n,i){return n-this.easeOutBounce(i-t,0,n,i)+e},easeOutBounce:function(t,e,n,i){return(t/=i)<1/2.75?7.5625*n*t*t+e:2/2.75>t?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,e,n,i){return i/2>t?.5*this.easeInBounce(2*t,0,n,i)+e:.5*this.easeOutBounce(2*t-i,0,n,i)+.5*n+e}},e.rafLast=0,e.requestAnimFrame=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||function(t){var n=(new Date).getTime(),i=Math.max(0,16-(n-e.rafLast)),a=window.setTimeout(function(){t(n+i)},i);return e.rafLast=n+i,a}}(),e.cancelAnimFrame=function(){return t.cancelAnimationFrame||t.cancelRequestAnimationFrame||t.webkitCancelAnimationFrame||t.webkitCancelRequestAnimationFrame||t.mozCancelAnimationFrame||t.mozCancelRequestAnimationFrame||function(t){clearTimeout(t)}}(),e.noop=function(){},e.tick=function(){var n=this;return function(){if(n.raf=e.requestAnimFrame.call(t,e.tick.call(n)),n.now=(new Date).getTime(),n.delta=n.now-n.then,n.delta>n.interval){for(var i=Object.keys(n.pipeline),a=i.length,o=0;a>o;o++)n.pipeline[i[o]]();n.then=n.now-n.delta%n.interval}}},e.FramePipeline=function(){var t=this;t.pipeline={},t.then=(new Date).getTime(),t.now=void 0,t.raf=void 0,t.delta=void 0,t.interval=1e3/e.fps},e.FramePipeline.prototype={add:function(t,e){this.pipeline[t]=e},remove:function(t){delete this.pipeline[t]},start:function(){e.tick.call(this)()},has:function(t){return t in this.pipeline},pause:function(){e.cancelAnimFrame.call(t,this.raf)},setFPS:function(t){this.interval=1e3/t}},e.pipeline=new e.FramePipeline,e.pipeline.start(),e.TweenController=function(){this.q=[]},e.TweenController.prototype={queue:function(){var t=new e.Tween(this),n=this.q[this.q.length-1];return!n||n&&n.hasCompleted?t.canStart=!0:(t.canStart=!1,n.then(function(){t.canStart=!0,t.start()})),this.q.push(t),t}},e.Tween=function(t){var n=this;n.name="$interpol-"+parseInt(Math.random()*(new Date).getTime()),n.controller=t||new e.TweenController,n.startVal=0,n.endVal=0,n.differences={},n.canStart=!0,n.hasStarted=!1,n.hasCompleted=!1,n.tweenDuration=400,n.delayDuration=0,n.isDelayed=!1,n.repeatCount=0,n.paused=!1,n.easing=e.easing.easeNone,n.onStep=e.noop,n.onComplete=e.noop,n.onStopped=e.noop,n.andThen=e.noop},e.Tween.prototype={from:function(t){return this.startVal=t,this},to:function(t){return this.endVal=t,this},duration:function(t){return this.tweenDuration=t,this},delay:function(t){return this.delayDuration=t,this},repeat:function(t){return this.repeatCount=t,this},ease:function(t){return this.easing=t,this},step:function(t){return this.onStep=t,this},complete:function(t){return this.onComplete=t,this},stopped:function(t){return this.onStopped=t,this},then:function(t){return this.andThen=t,this},reverse:function(){var t=this.startVal,e=this.endVal;this.startVal=e,this.endVal=t,this.start()},start:function(t){var n=this;if(!n.canStart)return n;if(n.delayDuration>0&&!n.isDelayed)return setTimeout(function(){n.start(t)},n.delayDuration),n.isDelayed=!0,n;t&&t.apply(n);var i=1e3/e.fps,a=n.tweenDuration/i;if("object"==typeof n.endVal){"object"!=typeof n.startVal&&(n.startVal={});for(var o in n.endVal)n.startVal.hasOwnProperty(o)||(n.startVal[o]=0),n.differences[o]=n.endVal[o]-n.startVal[o]}else n.differences["$itp-main"]=n.endVal-n.startVal;return n.hasStarted=!0,n.stpFn=function(){if(a>=0&&n.hasStarted){var t=n.tweenDuration;t-=a*i,a--;var o=n.differences.hasOwnProperty("$itp-main")?n.easing.call(e.easing,t,n.startVal,n.differences["$itp-main"],n.tweenDuration):{};if("object"==typeof o)for(var r in n.differences)o[r]=n.easing.call(e.easing,t,n.startVal[r],n.differences[r],n.tweenDuration);n.onStep.call(n,o)}else n.hasStarted?(e.pipeline.remove(n.name),n.hasStarted=!1,n.isDelayed=!1,n.repeatCount>0||-1===n.repeatCount||1/0===n.repeatCount?(n.repeatCount=n.repeatCount<0||1/0===n.repeatCount?n.repeatCount:n.repeatCount--,n.onComplete.call(n,n.endVal),n.start()):(n.hasCompleted=!0,n.onComplete.call(n,n.endVal),n.andThen.call(n),n.controller.q.shift())):(e.pipeline.remove(n.name),n.onStopped.call(n))},e.pipeline.add(n.name,n.stpFn),n},stop:function(){return this.hasStarted=!1,this},pause:function(){return e.pipeline.remove(this.name),this},play:function(){return e.pipeline.has(this.name)?void 0:(e.pipeline.add(this.name,this.stpFn),this)},queue:function(){return this.controller.queue()}};var n=function(t){return e.fps=t,e.pipeline.setFPS(e.fps),n};return n.easing=e.easing,n.tween=function(){return new e.Tween},n.queue=function(){return(new e.TweenController).queue()},n.pipeline=e.pipeline,n}),a("undefined"!=typeof Interpol?Interpol:window.Interpol)}.call(n,void 0,void 0,void 0,void 0,function(t){e.exports=t})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(t,e){(function(n){__browserify_shim_require__=t,function(t,e,n,i,a){var o=function(){var t=Date.now(),e=t,n=0,i=1/0,a=0,o=0,r=1/0,s=0,c=0,u=0,l=document.createElement("div");l.id="stats",l.addEventListener("mousedown",function(t){t.preventDefault(),y(++u%2)},!1),l.style.cssText="width:80px;opacity:0.9;cursor:pointer";var d=document.createElement("div");d.id="fps",d.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",l.appendChild(d);var h=document.createElement("div");h.id="fpsText",h.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",h.innerHTML="FPS",d.appendChild(h);var f=document.createElement("div");for(f.id="fpsGraph",f.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",d.appendChild(f);f.children.length<74;){var m=document.createElement("span");m.style.cssText="width:1px;height:30px;float:left;background-color:#113",f.appendChild(m)}var p=document.createElement("div");p.id="ms",p.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",l.appendChild(p);var g=document.createElement("div");g.id="msText",g.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",g.innerHTML="MS",p.appendChild(g);var v=document.createElement("div");for(v.id="msGraph",v.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",p.appendChild(v);v.children.length<74;){var m=document.createElement("span");m.style.cssText="width:1px;height:30px;float:left;background-color:#131",v.appendChild(m)}var y=function(t){switch(u=t){case 0:d.style.display="block",p.style.display="none";break;case 1:d.style.display="none",p.style.display="block"}},b=function(t,e){var n=t.appendChild(t.firstChild);n.style.height=e+"px"};return{REVISION:11,domElement:l,setMode:y,begin:function(){t=Date.now()},end:function(){var u=Date.now();return n=u-t,i=Math.min(i,n),a=Math.max(a,n),g.textContent=n+" MS ("+i+"-"+a+")",b(v,Math.min(30,30-n/200*30)),c++,u>e+1e3&&(o=Math.round(1e3*c/(u-e)),r=Math.min(r,o),s=Math.max(s,o),h.textContent=o+" FPS ("+r+"-"+s+")",b(f,Math.min(30,30-o/100*30)),e=u,c=0),u},update:function(){t=this.end()}}};a("undefined"!=typeof o?o:window.Stats)}.call(n,void 0,void 0,void 0,void 0,function(t){e.exports=t})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(t,e){function n(t){for(var e,n,i,a,o,r="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=new Uint8Array(t),u=c.byteLength,l=u%3,d=u-l,h=0;d>h;h+=3)o=c[h]<<16|c[h+1]<<8|c[h+2],e=(16515072&o)>>18,n=(258048&o)>>12,i=(4032&o)>>6,a=63&o,r+=s[e]+s[n]+s[i]+s[a];return 1==l?(o=c[d],e=(252&o)>>2,n=(3&o)<<4,r+=s[e]+s[n]+"=="):2==l&&(o=c[d]<<8|c[d+1],e=(64512&o)>>10,n=(1008&o)>>4,i=(15&o)<<2,r+=s[e]+s[n]+s[i]+"="),r}var i=function(t,e,i){var a,o=!1,r={uri:function(){return t},source:t};if(!e||!i)return r;var s=/\.(\w+)$/.exec(t)[1];a="data:image/"+s+";base64,"+n(e),r.uri=function(){return a},o=!0,i(r)};e.exports=i},{}],5:[function(t,e){function n(t){return function(e){return t.test(e)}}function i(t){return function(e){return e in s?!1:(s[e]=t(e),!0)}}var a=t("./loader"),o=t("./image"),r=t("./sound"),s={},c=/\.(gif|jpeg|jpg|png)$/,u=/\.(mp3|mp4|ogg)$/,l={};l.load=function(t){var e,l,d=[];"string"==typeof t?d.push(t):d=d.concat(t),e=d.filter(n(u)).filter(i(r)),l=d.filter(n(c)).filter(i(o));var h=new a(l,o),f=new a(e,r);return Promise.all([f.load(),h.load()]).then(function(t){var e=t[0],n=t[1];e.forEach(function(t){s[t.source]=t}),n.forEach(function(t){s[t.source]=t})})},l.get=function(t){return t in s?s[t]:void 0},e.exports=l},{"./image":4,"./loader":6,"./sound":8}],6:[function(t,e){var n=function(t,e){this.files=t,this.transform=e||function(t,e,n){return n(e)}};n.prototype.loadBuffer=function(t){var e=this;return new Promise(function(n,i){var a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="arraybuffer",a.onload=function(){e.transform(t,a.response,function(t){n(t)})},a.onerror=i,a.send()})},n.prototype.load=function(){var t=this,e=t.files.map(function(e){return t.loadBuffer(e)});return Promise.all(e)},e.exports=n},{}],7:[function(t,e){e.exports=window.AudioContext||window.webAudioContext||window.webkitAudioContext},{}],8:[function(t,e){function n(t,e,n){var i,o=!1,r={play:function(){if(o){var t=a.createBufferSource();t.buffer=i,t.onended=function(){t=null},t.connect(a.destination),t.start(0)}},source:t};return e&&n?void a.decodeAudioData(e,function(t){i=t,o=!0,n(r)}):r}var i=t("./context"),a=new i;e.exports=n},{"./context":7}],9:[function(t,e){var n=t("../utilities"),i=t("interpol"),a=t("../config"),o=t("../assetmanager"),r={x:0,y:0,sx:0,sy:0,vx:0,vy:0,radius:10,color:"#ffffff"};r.init=function(t,e,n,i,a,o){this.x=t||this.x,this.y=e||this.y,this.sx=t||this.x,this.sy=e||this.y,this.vx=n||this.vx,this.vy=i||this.vy,this.radius=a||this.radius,this.color=o||this.color},r.update=function(t,e,n,i){this.x+=this.vx+(n||0),this.y+=this.vy+(i||0),(this.x<-this.radius||this.x-this.radius>t||this.y<-this.radius||this.y-this.radius>e)&&(this.x=this.sx,this.y=this.sy)};var s={particles:[]};s.init=function(t,e,i){this.particles=[];for(var a=0;t>a;a++){var o=Object.create(r);o.init(e,i,n.floatRange(-1,1),n.floatRange(-1,1),n.floatRange(15,30),"rgba("+n.range(0,255)+","+n.range(0,255)+","+n.range(0,255)+","+n.floatRange(.1,.7)+")"),this.particles.push(o)}};var c={target:void 0,canvas:void 0,context:void 0,system:void 0};c.init=function(t){var e=this;e.target=t,e.canvas=document.createElement("canvas");var o=function r(){return e.canvas.width=n.windowWidth(),e.canvas.height=n.windowHeight(),r}();e.system=Object.create(s),e.system.init(250,e.canvas.width/2,e.canvas.height/2),window.addEventListener("resize",o),e.target.appendChild(e.canvas),e.context=e.canvas.getContext("2d"),a.global.useBackgroundAnimation&&i.pipeline.add("background",e.render.bind(e)),n.emitter.on("global_config_change",function(t,n){"useBackgroundAnimation"===t&&(n&&!i.pipeline.has("background")?i.pipeline.add("background",e.render.bind(e)):i.pipeline.has("background")&&(i.pipeline.remove("background"),e.context.clearRect(0,0,e.canvas.width,e.canvas.height)))})},c.render=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);var t=new Image;t.src=o.get("assets/img/playlogo-sml.png").uri();for(var e=0;e<this.system.particles.length;e++){var n=this.system.particles[e];n.update(this.canvas.width,this.canvas.height),this.context.drawImage(t,n.x,n.y,n.radius,n.radius)}},c.remove=function(){this.target.removeChild(this.canvas),i.pipeline.remove("background")},e.exports=c},{"../assetmanager":5,"../config":10,"../utilities":22,interpol:2}],10:[function(t,e){var n=t("./utilities"),i="http://labs.f5.io/essence/",a={};["displayMetrics","useSound","useAccelerometer","useGamification","useDynamicLighting","useBackgroundAnimation","useMessaging","isCeltra"].forEach(function(t){var e=!1;Object.defineProperty(a,t,{enumerable:!0,set:function(i){e=i,n.emitter.emit("global_config_change",t,e)},get:function(){return e}})}),a.displayMetrics=!1,a.useSound=!0,a.useAccelerometer=!0,a.useDynamicLighting=!0;var o={castShadow:!0,autoListen:!0,useInertia:!1,useBackgrounds:!0,useContent:!1,useVideo:!1,useGif:!1,cropLargeFaces:!1,isSequential:!1,normaliseFacialRotation:!0},r={displayMetrics:"Display Metrics",useSound:"Sound",useMessaging:"Post Messaging",useGamification:"Gamification",useDynamicLighting:"Dynamic Lighting",useBackgroundAnimation:"Background Animation",useInertia:"Inertial Interaction",useAccelerometer:"Accelerometer",useBackgrounds:"Face Backgrounds",useContent:"Face Content",useVideo:"Video Face Content",useGif:"GIF Face Content",cropLargeFaces:"Crop Full Face Assets",isSequential:"Sequential Interaction",normaliseFacialRotation:"Normalise Face Rotation",isCeltra:"Celtra Platform",castShadow:"Cast Shadow"},s={displayMetrics:"Display fps (frames per second) and frame time (in milliseconds).",useSound:"Have sounds throughout the Ad.",useMessaging:"For interaction with Ad Server APIs as an Iframe.",useGamification:'Puzzle comprised of four cubes, match the sides to "win".',useDynamicLighting:"Dynamically light the cubes with a forward facing light.",useBackgroundAnimation:"Turn on a simple background animation for performance testing.",useInertia:'Allow the user to "flick" the cube and it to gradually halt movement.',useAccelerometer:"Turn on rotation from Accelerometer/Gyro data.",useBackgrounds:"Show backgrounds on the cube faces.",useContent:"Show content on the cube faces.",useVideo:"Show a video on one face of the cube.",useGif:"Show a GIF on one face of the cube.",cropLargeFaces:"Use the full face assets on the gamified cube to reduce ad weight.",isSequential:"Always display the next face of the cube no matter which way it turns.",normaliseFacialRotation:"Always display cube faces at the correct orientation.",isCeltra:"Will be green if we are in Celtra.",castShadow:"Cast a shadow underneath the cube."};e.exports={BASE_URL:i,global:a,cube:o,titles:r,descriptions:s}},{"./utilities":22}],11:[function(t,e){var n=t("../utilities"),i={init:function(t,e,n,i,a){this.id=Math.random().toString(36).substr(5,10),this.width=t,this.height=e,this.index=n,this.name=i,this.target=a,this.rotation={X:0,Y:0,Z:0},this.translate={X:0,Y:0,Z:0},this.element=this.getElement(),this.target.appendChild(this.element)},getElement:function(){return n.getElement("div","common",{},{})},render:function(){this.element.style[n.CSS_TRANSFORM]="rotateX("+this.rotation.X+"deg) rotateY("+this.rotation.Y+"deg) rotateZ("+this.rotation.Z+"deg) translateX("+this.translate.X+"px) translateY("+this.translate.Y+"px) translateZ("+this.translate.Z+"px)"},remove:function(){this.element.parentNode.removeChild(this.element)}};e.exports=i},{"../utilities":22}],12:[function(t,e){var n=(t("../../utilities"),t("../../config")),i=(t("../../messaging"),t("../../assetmanager"),n.global.isCeltra?n.BASE_URL:"",{background:"assets/img/cubes/{name}/side{i}.jpg",sides:{music:[{html:function(){return""},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}}],books:[{html:function(){return""},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}}],apps:[{html:function(){return""},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}}],movies:[{html:function(){return""},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}},{html:function(){return'<a class="btn-buy"></a>'},onload:function(){}}]}});e.exports=i},{"../../assetmanager":5,"../../config":10,"../../messaging":20,"../../utilities":22}],13:[function(t,e){var n=t("../utilities"),i=t("./common"),a=t("./content"),o=t("../config"),r=t("../assetmanager"),s=Object.create(i);s.init=function(t,e,n,a,o,r){this.parent=r,this.parentID=r.id,i.init.apply(this,arguments),this.element.setAttribute("parent",this.parentID),this.translate.Z=this.width/2,this.renderedZ=this.rotation.Z},s.getElement=function(){return this.populateElement(n.getElement("div","side no"+(this.index+1),{index:this.index},{width:this.width+"px",height:this.height+"px"}))},s.populateElement=function(t){if(this.parent.config.useBackgrounds){var e=new Image,i=this.parent.config.cropLargeFaces?"main":this.name,s=o.global.isCeltra?o.BASE_URL+a.background:a.background,c=n.format(s,{i:this.index+1,name:i});e.src=r.get(c).uri(),e.width=this.width,e.height=this.height,this.parent.config.cropLargeFaces&&(e.width*=2,e.height*=2,e.style.left=n.isOdd(this.parent.index)?-this.width+"px":0,e.style.top=this.parent.index<2?0:-this.height+"px"),t.appendChild(e)}if(this.parent.config.useContent){var u=a.sides[this.name][this.index],l=document.createElement("span");l.className="content",l.innerHTML=u.html(this.parent.config),t.appendChild(l),u.onload(t,this.parent.config)}var d=document.createElement("div");return d.className="shadow",d.style.width=this.width+"px",d.style.height=this.height+"px",t.appendChild(d),t},s.changeContent=function(t){if(this.parent.config.useBackgrounds){var e=n("img",this.element)[0],i=o.global.isCeltra?o.BASE_URL+a.background:a.background,s=n.format(i,{i:t+1,name:this.name});e.src=r.get(s).uri()}if(this.parent.config.useContent){t=t>=a.sides[this.name].length?0:t;var c=a.sides[this.name][t],u=n(".content",this.element)[0];u.innerHTML=c.html(this.parent.config),c.onload(this.element,this.parent.config)}return t},s.render=function(){this.renderedZ=this.rotation.Z,i.render.apply(this)},e.exports=s},{"../assetmanager":5,"../config":10,"../utilities":22,"./common":11,"./content":12}],14:[function(t,e){var n=t("../utilities"),i=t("./content"),a=t("../config"),o=t("./vect3"),r=t("../assetmanager"),s=t("interpol"),c={init:function(t,e){function c(){for(var t=0;4>t;t++){var e={left:n.isEven(t)?0:this.width+"px",top:t>1?this.height+"px":0,width:this.width+"px",height:this.height+"px"},o=0===t?"50% 100%":1===t?"0 50%":2===t?"100% 50%":"50% 0",s=2>t?-91:91,c=0===t||3===t?"X":"Y";e[n.CSS_TRANSFORM_ORIGIN]=o,e[n.CSS_TRANSFORM]="rotate"+c+"("+s+"deg)";var u=n.getElement("div","fold",{},e),l=new Image,d=a.global.isCeltra?a.BASE_URL+i.background:i.background,h={i:this.faceIndex+1};h.name=this.cube.config.cropLargeFaces?"main":"cube0"+(t+1);var f=n.format(d,h);l.src=r.get(f).uri(),l.width=this.width,l.height=this.height,(this.cube.config.cropLargeFaces||this.cube.config.matchSides===!1)&&(l.width*=2,l.height*=2,l.style.left=n.isOdd(t+1)?0:-this.width+"px",l.style.top=2>t?0:-this.height+"px"),u.appendChild(l);var m=n.getElement("div","shadow",{},{});u.appendChild(m),this.element.appendChild(u),this.folds.push({start:s,axis:c,element:u,shadow:m})}}function u(){var t=this,e=[0,1,3,2,0,1,3,2];e=e.splice(e.indexOf(this.cubeIndex),4),e.forEach(function(e,i,r){var c=t.folds[e];if(0===i&&t.cube.config.matchSides!==!1)return c.element.style[n.CSS_TRANSFORM]="rotate"+c.axis+"(0deg)",void(c.shadow.style.opacity=0);var u=200,l=i*u;0===i&&(l=r.length*u),s.tween().from(c.start).to(0).delay(l).duration(u).step(function(e){if(c.element.style[n.CSS_TRANSFORM]="rotate"+c.axis+"("+e+"deg)",!a.global.useDynamicLighting)return void(c.shadow.style.opacity=0);var i=n.getTransform(c.element),r=o.rotate(t.lightTransform.translate,o.muls(i.rotate,-1)),s=n.computeVertexData(c.element),u=o.divs(o.sub(s.c,s.a),2),l=o.normalize(o.cross(o.sub(s.b,s.a),o.sub(s.c,s.a))),d=o.normalize(o.sub(r,u)),h=.75-Math.max(0,o.dot(l,d)).toFixed(3);c.light!==h&&(c.light=h,c.shadow.style.opacity=h)}).complete(function(){var e=t.cube.config.matchSides===!1?0:r.length-1;i===e&&n.emitter.emit("fold_out_complete",t.cubeRotation)}).start(function(){n.emitter.emit("fold_out_start",e,.5*u)})})}this.cube=t,this.width=t.width,this.height=t.height,this.target=t.target,this.faceIndex=e,this.cubeIndex=t.index,this.cubeRotation=t.rotation,this.folds=[];var l={width:2*this.width+"px",height:2*this.height+"px"};l[n.CSS_TRANSFORM]="translateZ("+Math.ceil(this.width/2)+"px)",this.light=n('[role="light"]')[0],this.lightTransform=n.getTransform(this.light),this.element=n.getElement("div","fold-container",{},l),this.target.appendChild(this.element),c.call(this),u.call(this)}};e.exports=c},{"../assetmanager":5,"../config":10,"../utilities":22,"./content":12,"./vect3":18,interpol:2}],15:[function(t,e){var n=t("../utilities"),i=t("./common"),a=t("./matrix"),o=t("./face"),r=t("./shadow"),s=t("./fold"),c=t("../config"),u=t("interpol"),l=t("../assetmanager"),d=t("./vect3"),h=Object.create(i);h.getElement=function(){return n.getElement("div","cube",{index:this.index},{width:this.width+"px",height:this.height+"px"})},h.init=function(t,e,h,f,m,p){function g(t){D.nextFaceIndex=0,D.faces.forEach(function(t){t.remove()});var e;t&&(e=n.clone(D.rotation),D.rotation={X:0,Y:0,Z:0},D.render()),D.faces=[];for(var i=0;6>i;i++){var a=Object.create(o);a.init(D.width,D.height,i,D.name,D.element,D),D.config.isSequential&&a.changeContent(D.currentContent),a.rotation.Y=1===i?180:2===i?90:3===i?-90:0,a.rotation.X=4===i?90:5===i?-90:0,a.render(),D.faces.push(a)}v(),t&&e&&(D.rotation=e,D.render())}function v(){D.faceData=D.faces.map(function(t){return n(".shadow",t.element)[0]}).map(function(t){var e=n.computeVertexData(t);return t.style.opacity=0,{verticies:e,normal:d.normalize(d.cross(d.sub(e.b,e.a),d.sub(e.c,e.a))),center:d.divs(d.sub(e.c,e.a),2),elem:t}})}function y(){D.element.addEventListener("touchstart",C),D.element.addEventListener("touchstart",function t(){n.emitter.emit("first_cube_interaction"),D.element.removeEventListener("touchstart",t)}),c.global.useGamification&&D.element.addEventListener("doubletap",function(t){var e=S(t.target),n=Object.create(s);n.init(D,e.index)})}function b(){D.faces.forEach(function(t){t.rotation.Z=0,t.render()})}function w(){ie=n.emitter.on(D.id,function(t){ie&&(ie=ie()),C(t)})}function x(){var t=F(D.rotation);["LR","UD"].forEach(function(e){var i=t[e],a=D.rotation[i],o=n.nearest(a,90),r=Math.abs(a-o)/45,s=D.shadow.originalScale+r*D.shadow.hypRatio/2;D.shadow.scale["LR"===e?"X":"Y"]=s}),D.shadow.render()}function C(t){D.element.removeEventListener("touchstart",C);var e=t.changedTouches[0];_=e.clientX,z=e.clientY,N=Date.now(),q=_,P=z,U=W=!1,velocity=H=0,Q?(Q.pause(),$=Q):(J=S(t.target),D.config.isSequential&&(D.currentContent++,D.faces.filter(function(t){return t.index!==J.index}).forEach(function(t){D.currentContent=t.changeContent(D.currentContent)}))),ae=n.clone(D.rotation),V=F(ae),document.addEventListener("touchmove",E),document.addEventListener("touchend",M)}function E(t){ie&&(ie=ie()),t.preventDefault();var e=t.changedTouches[0];j=e.clientX<q?"left":"right",Y=e.clientY<P?"up":"down",q=e.clientX,P=e.clientY;var i=document.elementFromPoint(q,P),a=L(i);if(a){var o=a.getAttribute("parent");if(o!==D.id){var r=function(){n.emitter.emit(o,n.extend({},t,{target:i}))};return void M(n.extend({},t,{onAnimComplete:r}))}}else if(!D.config.useInertia)return void M(t);var s=(_-q)/(D.width/90),l=(z-P)/(D.height/90),d=Math.abs(s),h=Math.abs(l);Math.max(d,h)<1||(n.isDefined(B)||(X=d>h?"leftright":"updown",B="leftright"===X?V.LR:V.UD,I(J,X)),G=Z,Z="leftright"===X?j:Y,G!==Z&&(W=!0,K=Date.now(),te=q,ee=P),ne=Date.now(),U=!0,H="leftright"===X?s:l,H=A(H),u.pipeline.has("render"+D.id)||u.pipeline.add("render"+D.id,function(){var t=D.rotation[B],e=Math.round(ae[B]+H),i=n.nearest(e,90),a=n.nearest(t,90);i!==a&&c.global.useSound&&D.sound.play(),D.rotation[B]=e,D.render()}))}function M(t){if(document.removeEventListener("touchmove",E),document.removeEventListener("touchend",M),D.config.isSequential&&U||(D.element.addEventListener("touchstart",C),w()),!U)return void($&&($.play(),$=void 0));u.pipeline.has("render"+D.id)&&u.pipeline.remove("render"+D.id);var e=t.changedTouches[0],i=Date.now(),a=e.clientX,o=e.clientY,r=a-te,s=o-ee,l="leftright"===X?r:s,d=i-K;l=0>l&&("right"===Z||"down"===Z)?Math.abs(l):l,l=l>0&&("left"===Z||"up"===Z)?-l:l;var h=l/d,f=Math.abs(l)<.8*D.width/2?1:0,m=ae[B],p=D.rotation[B],g=n.nearest(p,90),v=1;
if(D.config.useInertia&&Math.abs(h)>.8){var y=0>h?"min":"max",b=0>h?-f:f,x=Math.round(2*h);g-=A(90*Math[y](b,x)),v=Math.abs(g-p)/90}else{var S=n.nearest(m,90);g="up"===Z||"left"===Z?S+A(90):S-A(90)}var L,F=p,I=g,T="onAnimComplete"in t?100:300,O=!1;Q=u.tween().from(F).to(I).duration(Math.round(T*v)).ease(u.easing.easeOutCirc).step(function(e){L=L||e;var i=n.nearest(e,90),a=n.nearest(L,90);if(i!==a&&c.global.useSound&&D.sound.play(),D.rotation[B]=e,D.render(),L=e,"onAnimComplete"in t){var o=Math.abs(I-e);10>=o&&!O&&(O=!0,t.onAnimComplete())}}).complete(function(t){var e=n.norm(n.nearest(t,90)%360);D.rotation[B]=e,D.render(),k(),D.config.isSequential&&(D.element.addEventListener("touchstart",C),w()),B=void 0,Z=void 0,Q=void 0,R(D.rotation)}).start()}function S(t){var e=L(t);return n.isDefined(e)?D.faces[parseInt(e.getAttribute("index"),10)]:void 0}function L(t){for(var e=t;null!==e&&!/side/.test(e.className);)e=e.parentNode;return null!==e&&n.isDefined(e)?e:void 0}function F(t){var e=n.norm(n.nearest(t.X,90)%360),i=n.norm(n.nearest(t.Y,90)%360),a=90===e||270===e?"Z":"Y",o=90===i||270===i?"Z":"X",r=["X","Y","Z"].filter(function(t){return t!==a&&t!==o})[0];return{LR:a,UD:o,Mid:r}}function R(t,e){if(D.config.normaliseFacialRotation||"undefined"!=typeof e){var i=n.norm(n.nearest(t.X,90)%360),o=n.norm(n.nearest(t.Y,90)%360),r=n.norm(n.nearest(t.Z,90)%360);if("undefined"!=typeof e&&e!==!0)return a[e][i][o][r];for(var s=D.faces.length-1;s>=0;s--){var c=D.faces[s];c.rotation.Z=a[s][i][o][r],c.render()}}}function I(t,e){if(D.config.normaliseFacialRotation&&"updown"===e){var i=n.isEven(t.index)?t.index+1:t.index-1,a=D.faces[i];a.rotation.Z=a.renderedZ+180,a.render()}}function A(t){var e=n.norm(n.nearest(D.rotation.X,90)%360),i=n.norm(n.nearest(D.rotation.Y,90)%360);return"leftright"===X?180===e&&"Y"===B||90===e&&0===i||270===e&&("Z"!==B||180===i)?t:-t:270===i?-t:t}function k(){c.global.useGamification&&D.config.matchSides!==!1&&n.emitter.emit("rotation_complete")}function T(t){var e=document.elementFromPoint(n.windowWidth()/2,n.windowHeight()/2),i=S(e);D.name=t,D.faces.map(function(e){return e.name=t,e}).filter(function(t){return t.index!==i.index}).forEach(function(t){D.currentContent=t.changeContent(0)}),R(D.rotation);var a,o=F(D.rotation),r=n.range(0,100)<50?o.UD:o.LR,s=n.range(0,100)<50?90:-90;u.tween().from(0).to(s).ease(u.easing.easeOutCirc).step(function(t){D.rotation[r]=a+t,D.render()}).complete(function(){D.faces.forEach(function(t,e){t.changeContent(e)}),D.rotation.X=D.rotation.Y=D.rotation.Z=0,D.render(),v(),R(D.rotation)}).start(function(){a=D.rotation[r]})}i.init.apply(this,arguments),this.config=n.extend({},c.cube,p);var O="assets/sound/click.mp3";O=c.global.isCeltra?c.BASE_URL+O:O,this.sound=l.get(O),this.currentContent=0,this.nextFaceIndex=0,this.faces=[],this.faceData=[],this.shadow=Object.create(r),this.shadow.init(.8*this.width,.8*this.height,this.index,this.name,this.target.parentNode,this),this.shadow.opacity=this.config.castShadow?this.shadow.opacity:0,this.shadow.render(),this.light=n('[role="light"]')[0],this.lightTransform=n.getTransform(this.light);var D=this;g(),this.target.style[n.CSS_TRANSFORM]="translateZ(-"+this.width/2+"px)",this.config.autoListen&&y(),this.getFaceFromTarget=S,this.getNormalisedFaceRotation=R,this.rerenderFaces=g.bind(this,!0),this.resetNormalisedFaces=b,this.getAxisDefinition=F,this.changeCubeNameChangeInvisibleFacesAndRotate=T,this.forceRotationOfOppositeForFirstFace=I.bind(this,this.faces[0],"updown"),this.renderShadow=x,this.addInteractionListener=y;var _,z,N,q,P,V,B,X,j,Y,Z,G,H,U,W,Q,$,J,K,te,ee,ne,ie,ae=n.clone(this.rotation);document.addEventListener("touchstart",w),document.addEventListener("touchend",function(){ie&&ie()})},h.render=function(){if(i.render.call(this),this.config.castShadow&&this.renderShadow(),!c.global.useDynamicLighting)return void this.faceData.forEach(function(t){t.elem.style.opacity=0});for(var t,e,a,o=0,r=this.faceData.length,s=n.getTransform(this.element),u=d.rotate(this.lightTransform.translate,d.muls(s.rotate,-1));++o<r;)t=this.faceData[this.nextFaceIndex],e=d.normalize(d.sub(u,t.center)),a=1-Math.max(0,d.dot(t.normal,e)).toFixed(3),t.light!=a&&(t.light=a,t.elem.style.opacity=a),this.nextFaceIndex=(this.nextFaceIndex+1)%r},e.exports=h},{"../assetmanager":5,"../config":10,"../utilities":22,"./common":11,"./face":13,"./fold":14,"./matrix":16,"./shadow":17,"./vect3":18,interpol:2}],16:[function(t,e){e.exports={0:{0:{0:{0:0,90:270,180:180,270:90},90:{0:0,90:270,180:180,270:90},180:{0:0,90:270,180:180,270:90},270:{0:0,90:270,180:180,270:90}},90:{0:{0:0,90:270,180:180,270:90},90:{0:270,90:180,180:90,270:0},180:{0:180,90:90,180:0,270:270},270:{0:90,90:0,180:270,270:180}},180:{0:{0:180,90:90,180:0,270:270},90:{0:180,90:90,180:0,270:270},180:{0:180,90:90,180:0,270:270},270:{0:180,90:90,180:0,270:270}},270:{0:{0:0,90:270,180:180,270:90},90:{0:90,90:0,180:270,270:180},180:{0:180,90:90,180:0,270:270},270:{0:270,90:180,180:90,270:0}}},1:{0:{0:{0:0,90:90,180:180,270:270},90:{0:0,90:90,180:180,270:270},180:{0:0,90:90,180:180,270:270},270:{0:0,90:90,180:180,270:270}},90:{0:{0:180,90:270,180:0,270:90},90:{0:90,90:180,180:270,270:0},180:{0:0,90:90,180:180,270:270},270:{0:270,90:0,180:90,270:180}},180:{0:{0:180,90:270,180:0,270:90},90:{0:180,90:270,180:0,270:90},180:{0:180,90:270,180:0,270:90},270:{0:180,90:270,180:0,270:90}},270:{0:{0:180,90:270,180:0,270:90},90:{0:270,90:0,180:90,270:180},180:{0:0,90:90,180:180,270:270},270:{0:90,90:180,180:270,270:0}}},2:{0:{0:{0:0,90:270,180:180,270:90},90:{0:0,90:180,180:180,270:180},180:{0:0,90:90,180:180,270:270},270:{0:0,90:0,180:180,270:0}},90:{0:{0:270,90:270,180:270,270:270},90:{0:180,90:180,180:180,270:0},180:{0:90,90:90,180:90,270:90},270:{0:0,90:0,180:0,270:180}},180:{0:{0:180,90:270,180:0,270:90},90:{0:180,90:180,180:0,270:180},180:{0:180,90:90,180:0,270:270},270:{0:180,90:0,180:0,270:0}},270:{0:{0:90,90:90,180:90,270:90},90:{0:180,90:0,180:180,270:180},180:{0:270,90:270,180:270,270:270},270:{0:0,90:180,180:0,270:0}}},3:{0:{0:{0:0,90:270,180:180,270:90},90:{0:0,90:0,180:180,270:0},180:{0:0,90:90,180:180,270:270},270:{0:0,90:180,180:180,270:180}},90:{0:{0:90,90:90,180:90,270:90},90:{0:0,90:180,180:0,270:0},180:{0:270,90:270,180:270,270:270},270:{0:180,90:0,180:180,270:180}},180:{0:{0:180,90:270,180:0,270:90},90:{0:180,90:0,180:0,270:0},180:{0:180,90:90,180:0,270:270},270:{0:180,90:180,180:0,270:180}},270:{0:{0:270,90:270,180:270,270:270},90:{0:0,90:0,180:0,270:180},180:{0:90,90:90,180:90,270:90},270:{0:180,90:180,180:180,270:0}}},4:{0:{0:{0:0,90:270,180:180,270:90},90:{0:90,90:270,180:90,270:90},180:{0:180,90:270,180:0,270:90},270:{0:270,90:270,180:270,270:90}},90:{0:{0:180,90:180,180:180,270:180},90:{0:270,90:90,180:90,270:90},180:{0:0,90:0,180:0,270:0},270:{0:90,90:270,180:270,270:270}},180:{0:{0:0,90:90,180:180,270:270},90:{0:90,90:90,180:90,270:270},180:{0:180,90:90,180:0,270:270},270:{0:270,90:90,180:270,270:270}},270:{0:{0:0,90:0,180:0,270:0},90:{0:90,90:90,180:270,270:90},180:{0:180,90:180,180:180,270:180},270:{0:270,90:270,180:90,270:270}}},5:{0:{0:{0:0,90:270,180:180,270:90},90:{0:270,90:270,180:270,270:90},180:{0:180,90:270,180:0,270:90},270:{0:90,90:270,180:90,270:90}},90:{0:{0:0,90:0,180:0,270:0},90:{0:270,90:270,180:90,270:270},180:{0:180,90:180,180:180,270:180},270:{0:90,90:90,180:270,270:90}},180:{0:{0:0,90:90,180:180,270:270},90:{0:270,90:90,180:270,270:270},180:{0:180,90:90,180:0,270:270},270:{0:90,90:90,180:90,270:270}},270:{0:{0:180,90:180,180:180,270:180},90:{0:90,90:270,180:270,270:270},180:{0:0,90:0,180:0,270:0},270:{0:270,90:90,180:90,270:90}}}}},{}],17:[function(t,e){var n=t("../utilities"),i=t("./common"),a=(t("../config"),Object.create(i));a.init=function(t,e,n,a,o,r){this.originalScale=2,this.parent=r,this.scale={X:this.originalScale,Y:this.originalScale},this.opacity=.5,i.init.apply(this,arguments),this.translate.Z=-(.8*this.height),this.hypotenuse=Math.sqrt(this.width*this.width+this.height*this.height),this.hypRatio=this.hypotenuse/this.width-1},a.getElement=function(){var t=1.5,e="25px";return n.getElement("div","cube-shadow",{},{width:this.width/t+"px",height:this.height/t+"px",borderRadius:e})},a.render=function(){i.render.apply(this),this.element.style[n.CSS_TRANSFORM]+=" scale("+this.scale.X+","+this.scale.Y+")",this.element.style.opacity=this.opacity},e.exports=a},{"../config":10,"../utilities":22,"./common":11}],18:[function(t,e){var n={create:function(t,e,n){return{x:t||0,y:e||0,z:n||0}},add:function(t,e){return{x:t.x+e.x,y:t.y+e.y,z:t.z+e.z}},sub:function(t,e){return{x:t.x-e.x,y:t.y-e.y,z:t.z-e.z}},mul:function(t,e){return{x:t.x*e.x,y:t.y*e.y,z:t.z*e.z}},div:function(t,e){return{x:t.x/e.x,y:t.y/e.y,z:t.z/e.z}},muls:function(t,e){return{x:t.x*e,y:t.y*e,z:t.z*e}},divs:function(t,e){return{x:t.x/e,y:t.y/e,z:t.z/e}},len:function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},dot:function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},cross:function(t,e){return{x:t.y*e.z-t.z*e.y,y:t.z*e.x-t.x*e.z,z:t.x*e.y-t.y*e.x}},normalize:function(t){return n.divs(t,n.len(t))},ang:function(t,e){return Math.acos(n.dot(t,e)/(n.len(t)*n.len(e)))},copy:function(t){return{x:t.x,y:t.y,z:t.z}},equal:function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z},rotate:function(t,e){var n=t.x,i=t.y,a=t.z,o=e.x/2,r=e.y/2,s=e.z/2,c=Math.cos(o),u=Math.cos(r),l=Math.cos(s),d=Math.sin(o),h=Math.sin(r),f=Math.sin(s),m=c*u*l+-d*h*f,p=d*u*l- -c*h*f,g=c*h*l+d*u*-f,v=c*u*f- -d*h*l,y=1-2*(g*g+v*v),b=2*(p*g+v*m),w=2*(p*v-g*m),x=2*(p*g-v*m),C=1-2*(p*p+v*v),E=2*(v*g+p*m),M=2*(p*v+g*m),S=2*(g*v-p*m),L=1-2*(p*p+g*g);return{x:n*y+i*x+a*M,y:n*b+i*C+a*S,z:n*w+i*E+a*L}}};e.exports=n},{}],19:[function(t,e){function n(){i();var t=r('[role="debug"]')[0],e=document.createElement("div");e.className="close",e.addEventListener("tap",function(){t.classList.add("hidden"),document.addEventListener("touchmove",r.prevent),r.emitter.emit("debug_panel",!1)});var n=document.createElement("div");n.className="open",n.innerHTML="<span></span>",n.addEventListener("tap",function(){t.classList.remove("hidden"),document.removeEventListener("touchmove",r.prevent),r.emitter.emit("debug_panel",!0)});var a=document.createElement("div");a.className="main",t.appendChild(e),t.appendChild(n),t.appendChild(a);var c=document.createElement("h1");c.innerText="Cube Properties",a.appendChild(c),o=document.createElement("ul"),a.appendChild(o);var u=document.createElement("h1");u.innerText="Global Properties",a.appendChild(u);var l=document.createElement("ul");Object.keys(s.global).forEach(function(t){var e=document.createElement("li"),n=document.createElement("input");n.type="checkbox",n.id=t,s.global[t]&&n.setAttribute("checked",!0),n.addEventListener("change",function(e){s.global[t]=e.target.checked});var i=document.createElement("label");i.setAttribute("for",t),i.innerHTML="<h1>"+s.titles[t]+"</h1><p>"+s.descriptions[t]+"</p>",e.appendChild(n),e.appendChild(i),l.appendChild(e)}),a.appendChild(l),r.emitter.on("global_config_change",function(t,e){var n=r("input#"+t,a)[0];n.checked=e?!0:!1})}function i(){function t(){n.update(),i.update()}var e=r('[role="metrics"]')[0],n=new c;n.domElement.style.position="absolute",n.domElement.style.right="0px",n.domElement.style.bottom="0px";var i=new c;i.setMode(1),i.domElement.style.position="absolute",i.domElement.style.right="80px",i.domElement.style.bottom="0px",e.appendChild(n.domElement),e.appendChild(i.domElement),n.domElement.style.display=s.global.displayMetrics?"block":"none",i.domElement.style.display=s.global.displayMetrics?"block":"none",s.global.displayMetrics&&u.pipeline.add("stats",t),r.emitter.on("global_config_change",function(e,a){"displayMetrics"===e&&(n.domElement.style.display=a?"block":"none",i.domElement.style.display=a?"block":"none",u.pipeline[a?"add":"remove"]("stats",t))})}function a(t){if(o){o.innerHTML="";var e=t.map(function(t){return t.config});Object.keys(e[0]).forEach(function(n){var i=document.createElement("li"),a=document.createElement("input");a.type="checkbox",a.id=n,e[0][n]&&a.setAttribute("checked",!0),a.addEventListener("change",function(i){var a=i.target.checked;switch(e.forEach(function(t){"useVideo"!==n&&"useGif"!==n||!a||(t.useContent=!0,r("input#useContent",o)[0].checked=!0),"useContent"!==n||a||(t.useVideo=t.useGif=!1,r("input#useVideo",o)[0].checked=!1,r("input#useGif",o)[0].checked=!1),"isSequential"===n&&a&&(t.useInertia=!1,r("input#useInertia",o)[0].checked=!1),t[n]=a}),n){case"normaliseFacialRotation":case"useBackgrounds":case"useContent":case"useVideo":case"useGif":case"isSequential":t.forEach(function(t){t.rerenderFaces(),t.getNormalisedFaceRotation(t.rotation,!0)}),"normaliseFacialRotation"!==n||a||t.forEach(function(t){t.resetNormalisedFaces()})}});var c=document.createElement("label");c.setAttribute("for",n),c.innerHTML="<h1>"+s.titles[n]+"</h1><p>"+s.descriptions[n]+"</p>",i.appendChild(a),i.appendChild(c),o.appendChild(i)})}}var o,r=t("../utilities"),s=t("../config"),c=t("stats"),u=t("interpol");e.exports={init:n,defineCubeProperties:a}},{"../config":10,"../utilities":22,interpol:2,stats:3}],20:[function(t,e){var n,i;window.addEventListener("message",function(t){if(console.log(t),/\.celtra/.test(t.origin))switch(n&&i||(n=t.source,i=t.origin),t.data){case"init":n.postMessage("received_init",i)}});var a={post:function(t){n&&i&&n.postMessage(t,i)}};e.exports=a},{}],21:[function(t,e){function n(t){console.log("handler"),d.gamma=l.gamma,d.beta=l.beta,l.gamma=u.gamma-t.gamma,l.beta=u.beta-t.beta}function i(){var t=1/60,e=.3,n=t/(e+t),i=n*l.beta+(1-n)*d.beta,a=n*l.gamma+(1-n)*d.gamma;i*=.5,a*=.5,r.style[s.CSS_TRANSFORM]="rotateX("+i.toFixed(3)+"deg) rotateY("+a.toFixed(3)+"deg)"}function a(t){window.addEventListener("deviceorientation",function e(n){u.gamma=n.gamma,u.beta=n.beta,window.removeEventListener("deviceorientation",e),t&&t()})}function o(t){return console.log("orient"),r=t,a(),o}var r,s=t("../utilities"),c=t("interpol"),u={gamma:0,beta:0},l={gamma:0,beta:0},d={gamma:0,beta:0};o.listen=function(){return console.log("orient listen"),window.addEventListener("deviceorientation",n),c.pipeline.add("orient",i),o},o.detach=function(){return window.removeEventListener("deviceorientation",n),c.pipeline.remove("orient"),o},o.reset=function(t){return a(t),o},e.exports=o},{"../utilities":22,interpol:2}],22:[function(t,e){function n(t){var e=document.createElement("div"),n=null;return t.forEach(function(t){"undefined"!=typeof e.style[t]&&(n=t)}),n}function i(t){var e=t.charAt(0).toUpperCase()+t.substring(1),i=" ms Moz Webkit O".split(" ").map(function(n){return""===n?t:n+e});return n(i)}function a(t,e){return Array.prototype.slice.call((e||u).querySelectorAll(t))}function o(t){var e,n=t.split(/\s*[(),]\s*/).slice(1,-1);return e=6===n.length?{m11:+n[0],m21:+n[2],m31:0,m41:+n[4],m12:+n[1],m22:+n[3],m32:0,m42:+n[5],m13:0,m23:0,m33:1,m43:0,m14:0,m24:0,m34:0,m44:1}:16===n.length?{m11:+n[0],m21:+n[4],m31:+n[8],m41:+n[12],m12:+n[1],m22:+n[5],m32:+n[9],m42:+n[13],m13:+n[2],m23:+n[6],m33:+n[10],m43:+n[14],m14:+n[3],m24:+n[7],m34:+n[11],m44:+n[15]}:{m11:1,m21:0,m31:0,m41:0,m12:0,m22:1,m32:0,m42:0,m13:0,m23:0,m33:1,m43:0,m14:0,m24:0,m34:0,m44:1}}function r(t,e){return{x:t.x+e.x,y:t.y+e.y,z:t.z+e.z}}function s(t,e){var n=t.x,i=t.y,a=t.z,o=e.x/2,r=e.y/2,s=e.z/2,c=Math.cos(o),u=Math.cos(r),l=Math.cos(s),d=Math.sin(o),h=Math.sin(r),f=Math.sin(s),m=c*u*l+-d*h*-f,p=d*u*l- -c*h*-f,g=c*h*l+d*u*f,v=c*u*f- -d*h*-l,y=1-2*(g*g+v*v),b=2*(p*g+v*m),w=2*(p*v-g*m),x=2*(p*g-v*m),C=1-2*(p*p+v*v),E=2*(v*g+p*m),M=2*(p*v+g*m),S=2*(g*v-p*m),L=1-2*(p*p+g*g);return{x:n*y+i*x+a*M,y:n*b+i*C+a*S,z:n*w+i*E+a*L}}var c=window,u=document;a.ready=function(t){return"complete"===u.readyState?setTimeout(t,1):void c.addEventListener("DOMContentLoaded",t)},a.extend=function(){for(var t=[].slice.call(arguments),e=t[0],n=1,i=t.length;i>n;n++){var a=t[n];for(var o in a)a.hasOwnProperty(o)&&(e[o]=a[o])}return e},a.clone=function(t){return a.extend({},t)},a.norm=function(t){return t>=0?t:360-Math.abs(t)},a.deg2rad=function(t){return.017453292519943295*t},a.rad2deg=function(t){return 57.29577951308232*t},a.prevent=function(t){t.preventDefault()},a.format=function(t,e){return t.toString().replace(/\{([^}]+)\}/g,function(t,n){return e[n]})},a.range=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},a.floatRange=function(t,e){return Math.random()*(e-t)+t},a.nearest=function(t,e){return Math.round(t/e)*e},a.isEven=function(t){return t%2===0},a.isOdd=function(t){return t%2!==0},a.isDefined=function(t){return void 0!==t},a.getElement=function(t,e,n,i){var a=u.createElement(t);return a.className=e,Object.keys(n).forEach(function(t){a.setAttribute(t,n[t])}),Object.keys(i).forEach(function(t){a.style[t]=i[t]}),a},a.getRandomRotation=function(t){return t=t||[0,90,180,270],t[a.range(0,t.length-1)]},a.emitter=function(){function t(){var t=[].slice.call(arguments),e=t[0],i=t[1],o=t[2]||a;n[e]=n[e]||[],n[e].push({fn:i,scope:o});var r=n[e].length-1;return function(){n[e].splice(r,1)}}function e(){var t=[].slice.call(arguments),e=t[0],i=t.slice(1);e in n&&n[e].forEach(function(t){t.fn.apply(t.scope,i)})}var n={};return{on:t,emit:e}}(),a.windowWidth=function(){if("undefined"!=typeof c.innerWidth)return function(){return c.innerWidth};var t="clientWidth"in u.documentElement?u.documentElement:u.body;return function(){return t.clientWidth}}(),a.windowHeight=function(){if("undefined"!=typeof c.innerHeight)return function(){return c.innerHeight};var t="clientHeight"in u.documentElement?u.documentElement:u.body;return function(){return t.clientHeight}}(),a.CSS_TRANSFORM=i("transform"),a.CSS_TRANSFORM_ORIGIN=i("transformOrigin"),a.CSS_PERSPECTIVE=i("perspective"),a.computeVertexData=function(t){for(var e,n=t.offsetWidth,i=t.offsetHeight,o={a:{x:-n/2,y:-i/2,z:0},b:{x:n/2,y:-i/2,z:0},c:{x:n/2,y:i/2,z:0},d:{x:-n/2,y:i/2,z:0}};1===t.nodeType;)e=a.getTransform(t),o.a=r(s(o.a,e.rotate),e.translate),o.b=r(s(o.b,e.rotate),e.translate),o.c=r(s(o.c,e.rotate),e.translate),o.d=r(s(o.d,e.rotate),e.translate),t=t.parentNode;return o},a.getTransform=function(t){var e,n,i=getComputedStyle(t,null)[a.CSS_TRANSFORM],r=o(i),s=Math.asin(-r.m13);return e=Math.atan2(r.m23,r.m33),n=Math.atan2(r.m12,r.m11),{transformStyle:i,matrix:r,rotate:{x:e,y:s,z:n},translate:{x:r.m41,y:r.m42,z:r.m43}}},function(){if(u.addEventListener){var t,e,n=function(t,e){var n=u.createEvent("CustomEvent");return n.initCustomEvent(e,!0,!0,t.target),t.target.dispatchEvent(n)||n.preventDefault(),n=null,!1},i=!0,a={x:0,y:0},o={x:0,y:0},r={touchstart:function(t){a.x=t.touches[0].pageX,a.y=t.touches[0].pageY},touchmove:function(t){i=!1,o.x=t.touches[0].pageX,o.y=t.touches[0].pageY},touchend:function(r){if(i){if(n(r,"fastclick"),n(r,"tap"),r.target===t){var s=Date.now()-e;500>s&&n(r,"doubletap")}t=r.target,e=Date.now()}else{var c=o.x-a.x,u=Math.abs(c),l=o.y-a.y,d=Math.abs(l);Math.max(u,d)>20&&(n(r,u>d?0>c?"swipeleft":"swiperight":0>l?"swipeup":"swipedown"),i=!0)}},touchcancel:function(){i=!1}};for(var s in r)u.addEventListener(s,r[s])}}(),e.exports=a},{}]},{},[1]);